define("local_catquiz/subscribe",["exports","core/ajax","core/templates"],(function(_exports,_ajax,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * @module     local_catquiz/subscribe
   * @copyright  2023 Wunderbyte GmbH <info@wunderbyte.at>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);var SELECTORS_SUBSCRIBEBUTTON="a.catquiz-button-subscribe";_exports.init=function(itemid,area){console.log("subscribe",itemid,area);var selector=SELECTORS_SUBSCRIBEBUTTON+'[data-id="'+itemid+'"][data-area="'+area+'"]',buttons=document.querySelectorAll(selector);console.log(selector,buttons),buttons&&buttons.forEach((function(button){console.log("add click listener ",button),button.dataset.initialized||(button.dataset.initialized="true",button.addEventListener("click",(function(e){e.stopPropagation(),console.log("clicked ",e.target),function(itemid,area,userid){_ajax.default.call([{methodname:"local_catquiz_subscribe",args:{userid:userid,area:area,itemid:itemid},done:function(res){console.log(res);var data={id:itemid,area:area};1==res.subscribed&&(data.subscribed="true"),_templates.default.renderForPromise("local_catquiz/button_subscribe",data).then((function(_ref){var html=_ref.html,js=_ref.js,selector=SELECTORS_SUBSCRIBEBUTTON+'[data-id="'+itemid+'"][data-area="'+area+'"]';return document.querySelectorAll(selector).forEach((function(button){_templates.default.replaceNode(button,html,js)})),!0})).catch((function(e){console.log(e)}))},fail:function(ex){console.log("ex:"+ex)}}])}(itemid,area,0)})))}))}}));

//# sourceMappingURL=subscribe.min.js.map