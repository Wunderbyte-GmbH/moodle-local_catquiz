define("local_catquiz/manage_catscale",["exports","core_form/modalform","core/str","core/ajax","local_catquiz/notifications"],(function(_exports,_modalform,_str,_ajax,_notifications){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.performDeletion=_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_ajax=_interopRequireDefault(_ajax);_exports.init=function(){console.log("manage catscale init"),document.querySelectorAll(".manage-catscale").forEach((function(button){button.addEventListener("click",(function(e){e.preventDefault();var element=e.target;"delete"===element.dataset.action?performDeletion(element):function(button){var parentelement=button.closest(".list-group-item"),action=button.dataset.action,formclass="local_catquiz\\form\\modal_manage_catscale",formvalues={id:parentelement.dataset.id,description:parentelement.dataset.description,name:parentelement.dataset.name,parentid:parentelement.dataset.parentid};if("create"===(console.log(formvalues),action))formvalues={parentid:parentelement.dataset.id};var modalForm=new _modalform.default({formClass:formclass,args:formvalues,modalConfig:{title:(0,_str.get_string)("managecatscale","local_catquiz")},returnFocus:button});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(function(e){window.console.log(e.detail),window.location.reload(),console.log("createCatscale: form submitted")})),modalForm.show()}(element)}))}))};var fn,_ref,performDeletion=(fn=regeneratorRuntime.mark((function _callee(element){var parentelement,id;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:console.log("performDeletion"),parentelement=element.closest(".list-group-item"),id=parentelement.dataset.id,_ajax.default.call([{methodname:"local_catquiz_delete_catscale",args:{id:id},done:function(res){console.log(res),res.success?window.location.reload():(0,_notifications.showNotification)(res.message,"danger")},fail:function(ex){console.log("ex:"+ex)}}]);case 4:case"end":return _context.stop()}}),_callee)})),_ref=function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))},function(_x){return _ref.apply(this,arguments)});_exports.performDeletion=performDeletion}));

//# sourceMappingURL=manage_catscale.min.js.map